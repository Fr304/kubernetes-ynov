# kube-prometheus-stack — Helm values
# Chart    : prometheus-community/kube-prometheus-stack v80.14.3
# Release  : monitoring
# Namespace: monitoring
#
# Installation :
#   helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
#   helm repo update
#   helm install monitoring prometheus-community/kube-prometheus-stack \
#     --namespace monitoring --create-namespace \
#     --version 80.14.3 \
#     -f values.yaml
#
# Mise à jour :
#   helm upgrade monitoring prometheus-community/kube-prometheus-stack \
#     --namespace monitoring \
#     --version 80.14.3 \
#     -f values.yaml

# -------------------------------------------------------------------
# Prometheus
# -------------------------------------------------------------------
prometheus:
  prometheusSpec:
    retention: 10d
    replicas: 1
    # Sélectionne toutes les PrometheusRules et ServiceMonitors
    ruleSelector: {}
    ruleNamespaceSelector: {}
    serviceMonitorSelector: {}
    serviceMonitorNamespaceSelector: {}
    podMonitorSelector: {}
    podMonitorNamespaceSelector: {}

# -------------------------------------------------------------------
# Alertmanager
# -------------------------------------------------------------------
alertmanager:
  alertmanagerSpec:
    retention: 120h
    replicas: 1

# -------------------------------------------------------------------
# Grafana (géré par la stack — distinct du grafana dans monitoring/)
# -------------------------------------------------------------------
grafana:
  enabled: true
  adminPassword: prom-operator   # À changer en production !
  ingress:
    enabled: false               # Ingress géré séparément (services/ingress.yaml)

# -------------------------------------------------------------------
# Composants intégrés
# -------------------------------------------------------------------
kubeStateMetrics:
  enabled: true

nodeExporter:
  enabled: true

# Composants control-plane activés après fix des bind-address (voir kubeadm/README.md)
# etcd        : --listen-metrics-urls=http://0.0.0.0:2381
# scheduler   : --bind-address=0.0.0.0
# controller  : --bind-address=0.0.0.0
kubeControllerManager:
  enabled: true
  endpoints:
  - 192.168.1.142

kubeScheduler:
  enabled: true
  endpoints:
  - 192.168.1.142

kubeEtcd:
  enabled: true
  endpoints:
  - 192.168.1.142
  service:
    port: 2381
    targetPort: 2381

# kube-proxy non accessible en bare-metal kubeadm
kubeProxy:
  enabled: false
